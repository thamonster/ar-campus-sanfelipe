<!DOCTYPE html>
<html>
  <head>
    <title>Depuración Terror San Felipe</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    
    <script>
      AFRAME.registerComponent('model-loader', {
        init: function () {
          console.log("Intentando cargar modelo...");
          this.el.addEventListener('model-loaded', () => {
            console.log("¡ÉXITO! El modelo se cargó.");
            // Ocultar el cubo de prueba si el modelo carga
            document.getElementById('test-cube').setAttribute('visible', 'false');
          });
          this.el.addEventListener('model-error', (e) => {
            console.error("ERROR CRÍTICO: El modelo no cargó.", e);
            alert("Error: No se encuentra el archivo .glb. Revisa el nombre.");
          });
        }
      });

      // Script para forzar permisos en iOS/Android al tocar la pantalla
      function initAudioVideo() {
        // Habilitar contexto de audio y video si fuera necesario
        document.getElementById('overlay').style.display = 'none';
      }
    </script>

    <style>
      #overlay {
        position: fixed; z-index: 999; top: 0; left: 0; width: 100%; height: 100%;
        background: black; display: flex; justify-content: center; align-items: center;
      }
      button {
        padding: 20px; background: red; color: white; border: none; font-size: 20px; font-weight: bold;
      }
    </style>
  </head>

  <body>
    <div id="overlay">
      <button onclick="initAudioVideo()">ENTRAR AL SISTEMA</button>
    </div>

    <a-scene loading-screen="dotsColor: red; backgroundColor: black" vr-mode-ui="enabled: false">
      
      <a-sky color="#050505"></a-sky>

      <a-scene fog="type: exponential; density: 0.02; color: #050505;"></a-scene>

      <a-light type="ambient" color="#ffffff" intensity="1"></a-light>
      <a-light type="point" position="0 2 0" intensity="2" color="red"></a-light>

      <a-box id="test-cube" position="0 1 -3" color="red" scale="1 1 1" animation="property: rotation; to: 0 360 0; loop: true; dur: 3000"></a-box>

      <a-entity id="campus-model"
                src="./escuela_terror.glb"
                gltf-model="./escuela_terror.glb"
                position="0 -1.6 0"
                scale="1 1 1"
                model-loader>
      </a-entity>

      <a-entity camera look-controls position="0 1.6 0">
        <a-entity cursor="fuse: false; rayOrigin: mouse;"></a-entity>
      </a-entity>

    </a-scene>
  </body>
</html>
